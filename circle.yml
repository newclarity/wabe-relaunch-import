#
# circle.yaml
#
machine:
    timezone:
        America/New_York

    php:
        version: 7.0.20

    environment:

        #
        # Define the Deployment provider
        #
        DEPLOY_PROVIDER:  "pantheon"

        #
        # The database credentials for WordPress on CircleCI
        #
        DB_HOST:        127.0.0.1
        DB_NAME:        wordpress
        DB_USER:        wordpress
        DB_PASSWORD:    wordpress

        #
        # The version of PHP defined above
        #
        PHP_VERSION:    "$(phpenv global)"

        #
        # The root for this repo in CircleCI
        #
        REPO_ROOT:   "${HOME}/${CIRCLE_PROJECT_REPONAME}"

        #
        # The roots for all the workflow related files and code
        #
        WORKFLOW_ROOT:  "${REPO_ROOT}/workflow"
        SHARED_SCRIPTS: "${WORKFLOW_ROOT}/shared/scripts.sh"
        PROVIDERS_ROOT: "${WORKFLOW_ROOT}/providers"
        INCLUDES_ROOT:  "${WORKFLOW_ROOT}/includes"

        
        
        OLD_STORY_START_ID:     375000
        OLD_STORY_END_ID:       407946
        OLD_STORY_END_DATE:     "2015-10-31"
        
        NEW_META_START_ID:      4000000
        TERM_ID_START:          2000
        
        PANTHEON_SITE_NAME:     "wabe"
        WWW_HOST:               "http://import-wabe.pantheonsite.io"

        IMPORT_POSTS:           "import_posts"
        IMPORT_META:            "import_postmeta"
        IMPORT_TERMS:           "import_terms"
        IMPORT_TT:              "import_term_taxonomy"
        IMPORT_TR:              "import_term_relationships"
        
        SOURCE_POSTS:           "wp_posts"
        SOURCE_META:            "wp_postmeta"
        SOURCE_TERMS:           "wp_terms"
        SOURCE_TT:              "wp_term_taxonomy"
        SOURCE_TR:              "wp_term_relationships"
        
        PREVIEW_CREDENTIALS: |
            HOST=dbserver.preview.d5981687-a2b6-4a2c-9456-ae933c90b097.drush.in
            USER=pantheon
            PASS=5d2c4707db8b42f6900ad610d74ad362
            PORT=16159
            NAME=pantheon

        IMPORT_CREDENTIALS: |
            HOST=dbserver.import.d5981687-a2b6-4a2c-9456-ae933c90b097.drush.in
            USER=pantheon
            PASS=ef4d5a6cfe564c0c84b86bfb7013d9d6
            PORT=11409
            NAME=pantheon

        POST_TYPES: |
            page
            wabe_person
            wabe_show
            wabe_guide
            wabe_press_release  (name?)
            wabe_home_config  (name?)
            nav-menu-item

        TAXONOMIES: |
            wabe_person_role
            wabe_show_genre
            wabe_person_role

        OTHER:
            yoast
            menu_location
            wp_options(?)

    hosts:
        wabe-relaunch.test: 127.0.0.1
        www.wabe-relaunch.test: 127.0.0.1

#checkout:

dependencies:
    override:
        - workflow/dependencies.sh

compile:
    override:
        - workflow/compile.sh


test:
    override:
        - echo 'No tests, just say us Okay!'


deployment:

  deploy:
    branch: /.+/
    commands:
    - devops/core/deployment.sh


